{
    "general": {
        "login_password": "123456",
        "login_param": "MiniWafLogin",
        "logout_param": "MiniWafLogout",
        "dashboard_param": "MiniWafDashboard",
        "token_param": "MiniWafToken",
        "token_duration": 600,
        "blockRequestText": "no",
        "check_sql": true,
        "check_rce": true,
        "check_lfi": true,
        "check_deserialization": true,
        "check_xss": true,
        "check_xxe": true,
        "check_ssrf": true,
        "check_flag_file": true,
        "check_upload": true,
        "request_body_log_max_length": 100,
        "response_body_log_max_length": 10,
        "upload_content_max_length": 100,
        "max_decode_depth": "5",
        "skip_cookies": [
            "PHPSESSID"
        ],
        "banned_ips": [
            "1.1.1.1",
            "1.1.1.2"
        ],
        "tokens": {
            "bac2508e688e9b3aa7526f9b2934a63c40034fd1531438bc2672302e5881b18e": {
                "authenticated": true,
                "login_time": 1759058851,
                "expire_time": 1759059451,
                "ip": "::1"
            }
        }
    },
    "patterns": {
        "sql": [
            "\/\\b(SELECT\\s+\\w+\\s+FROM|INSERT\\s+INTO\\s+\\w+|UPDATE\\s+\\w+\\s+SET|DELETE\\s+FROM\\s+\\w+|DROP\\s+(TABLE|DATABASE)\\s+\\w+|ALTER\\s+TABLE\\s+\\w+|CREATE\\s+(TABLE|DATABASE)\\s+\\w+|TRUNCATE\\s+TABLE\\s+\\w+)\\b\/i",
            "\/\\bUNION\\s+(ALL\\s+)?SELECT\\s+[\\w\\s,()]+FROM\\b\/i",
            "\/\\b(OR|AND|XOR|NOT)\\s+(\\d+\\s*=\\s*\\d+|'[^']*'\\s*=\\s*'[^']*')\\s*(OR|AND|XOR|NOT)?\\b\/i",
            "\/--\\s*[^\\n\\r]*$\/m",
            "\/#.*$\/m",
            "\/\\\/\\*[^*]*\\*+(?:[^\/*][^*]*\\*+)*\\\/\/s",
            "\/\\b(LOAD_FILE|INTO\\s+(OUTFILE|DUMPFILE)|SLEEP|BENCHMARK)\\s*\\(\/i",
            "\/\\bINFORMATION_SCHEMA\\.(TABLES|COLUMNS|SCHEMATA)\\b\/i",
            "\/@@(VERSION|DATADIR)\\b\/i",
            "\/'\\s*\\+\\s*'\/",
            "\/0x[0-9a-fA-F]{8,}\/",
            "\/\\b(AND|OR)\\s+\\d+\\s*=\\s*\\d+\\b\/i",
            "\/\\b(AND|OR)\\s+'[^']*'\\s*=\\s*'[^']*'\\b\/i",
            "\/extractvalue\\s*\\(\\s*[^,]+,\\s*concat\\s*\\(\/i",
            "\/updatexml\\s*\\(\\s*[^,]+,\\s*concat\\s*\\(\/i",
            "\/exp\\s*\\(\\s*~\\s*\\(\/i",
            "\/floor\\s*\\(\\s*rand\\s*\\([^)]*\\)\\s*\\*\\s*2\\s*\\)\/i",
            "\/(geometrycollection|multipoint|polygon|linestring)\\s*\\(\\s*select\/i"
        ],
        "rce": [
            "\/\\b(?:system|exec|shell_exec|passthru|popen|proc_open|pcntl_exec)\\s*\\(\/i",
            "\/\\b(?:eval|assert|create_function)\\s*\\(\/i",
            "\/`[^`]*(?:\\$|\\||&|;|>|<|\\b(?:cat|ls|rm|wget|curl|bash|sh)\\b)[^`]*`\/i",
            "\/\\b(?:os\\.system|os\\.popen|subprocess\\.(?:run|call|check_output|Popen))\\s*\\(\/i",
            "\/\\b(?:child_process\\.(?:exec|execSync|spawn))\\s*\\(\/i",
            "\/\\bRuntime\\.getRuntime\\(\\)\\.exec\\s*\\(\/i",
            "\/\\bSystem\\.Diagnostics\\.Process\\.Start\\s*\\(\/i",
            "\/<\\?(?:php|=)?\\s*(?:eval|system|exec|passthru|shell_exec)\/i",
            "\/<%\\s*(?:eval|Execute|Response\\.Write)\/i",
            "\/\\b(?:eval|assert)\\s*\\(\\s*\\$_(?:POST|GET|REQUEST|COOKIE)\/i",
            "\/\\bcreate_function\\s*\\([^,]*,\\s*\\$_(?:POST|GET|REQUEST|COOKIE)\/i",
            "\/\\b(?:unserialize|json_decode)\\s*\\([^)]*\\b(?:O:|C:|a:|s:|i:|N;)\/i",
            "\/base64_decode\\s*\\([^)]*[+\/0-9A-Za-z]{20,}\/i",
            "\/^(?!.*\\.php$).*\\b(?:system|exec|eval)\\s*\\(\/i"
        ],
        "lfi": [
            "\/\\.\\.\\\/.*\\.\\.\\\/.*\\.\\.\\\/\/i",
            "\/\\.\\.\\\\.*\\.\\.\\\\\/i",
            "\/\\b(?:etc\\\/passwd|boot\\.ini|win\\.ini|system32|\\\/etc\\\/shadow|\\\/proc\\\/self)\\b\/i",
            "\/php:\\\/\\\/filter\\\/(convert\\.|read=)\/i",
            "\/php:\\\/\\\/input.*(POST|PUT|PATCH)\/i",
            "\/data:\\\/\\\/.*base64\/i",
            "\/file:\\\/\\\/\\\/(etc|proc|dev|sys|boot|windows)\/i",
            "\/expect:\\\/\\\/\/i",
            "\/phar:\\\/\\\/\/i",
            "\/%2e%2e%2f.*%2e%2e%2f\/i",
            "\/\\.\\.%5c.*\\.\\.%5c\/i",
            "\/%00.*\\.(php|phar|inc)\/i",
            "\/\\x00.*\\.(php|phar|inc)\/i",
            "\/(\\.\\.+[\\\/\\\\][^\\s]*){4,}\/i",
            "\/\\\/(?:apache|nginx|httpd)\\\/(?:logs|conf)\\\/[^\\s]*\\.(?:log|conf)\/i",
            "\/\\b(?:passwd|shadow|group|hosts|httpd\\.conf|my\\.cnf)\\b.*\\.\\.\\\/\/i",
            "\/\\binclude_path\\s*=\\s*[\\\"\\'][^\\\"\\']*\\.{3,}\/i",
            "\/\\b(?:include|require|include_once|require_once)\\s*\\([^)]*\\.{3,}\/i"
        ],
        "lfi_whitelist": [
            "^home$",
            "^about$",
            "^contact$",
            "^header\\.php$",
            "^footer\\.php$",
            "^en_US$",
            "^zh_CN$",
            "^templates\/[^\/]+\\.tpl$",
            "^pages\/[a-zA-Z0-9_-]+\\.html$",
            "^includes\/[a-zA-Z]+\\.inc$",
            "^assets\/",
            "^js\/",
            "^css\/",
            "^images\/",
            "^static\/",
            "^vendor\/",
            "^node_modules\/",
            "^uploads\/",
            "^public\/",
            "^resources\/",
            "^themes\/",
            "^plugins\/",
            "^modules\/",
            "^components\/",
            "^dist\/",
            "^build\/",
            "^src\/",
            "^lib\/",
            "^media\/",
            "^content\/",
            "^files\/",
            "^downloads\/",
            "\\.(js|css|jpg|jpeg|png|gif|ico|svg|woff|ttf|eot|otf|mp4|webm|mp3|wav|pdf|doc|docx|xls|xlsx|zip|rar|7z)$"
        ],
        "deserialization": [
            "\/\\b(?:unserialize|json_decode)\\s*\\([^)]*\\b(?:O:|C:|a:|s:|i:|N;)\/i",
            "\/\\bObjectInputStream\\.readObject\\s*\\(\/i",
            "\/\\bpickle\\.loads\\s*\\(\/i",
            "\/\\b(?:yaml\\.load|yaml\\.unsafe_load)\\s*\\(\/i",
            "\/\\bMarshal\\.load\\s*\\(\/i",
            "\/\\b(?:unserialize|json_decode)\\s*\\([^)]*\\b(?:Tzo|Qzo|YTo|czo|aTo|Tjs=)\/i",
            "\/\\bObjectInputStream\\.readObject\\s*\\([^)]*\\b(?:ysoserial|CommonsCollections|C3P0|JRMP)\/i",
            "\/!!python\\\/object\\b\/i",
            "\/!!(python|java|js|ruby|perl|php)\\\/\/i",
            "\/\\b(?:unserialize|json_decode)\\s*\\([^)]*\\bO:\\d+:\\s*[\\\"\\'](?:SoapClient|SplDoublyLinkedList|Phar|SimpleXMLElement|DOMDocument|Exception|Error|ReflectionFunction|GuzzleHttp\\\\Client|Monolog\\\\Handler\\\\SyslogUdpHandler|Zend\\\\Di\\\\Di|CodeIgniter\\\\Session\\\\Handlers\\\\DatabaseHandler)[\\\"\\']\/i",
            "\/phar:\\\/\\\/[^\\s]+\\.phar\/i",
            "\/\\binclude\\s*\\([^)]*phar:\\\/\\\/\/i",
            "\/PHPSESSID=[a-zA-Z0-9+\\\/]*?(?:Tzo|O:|C:|a:|s:|i:|N;)\/i",
            "\/\\b(?:InvokerTransformer|InstantiateTransformer|ChainedTransformer|ConstantTransformer|URLDNS|JRMPClient|CommonsBeanutils|Hibernate|Spring|Fastjson)\/i",
            "\/\\{\\s*[\\\"\\']@type[\\\"\\']\\s*:\\s*[\\\"\\'][\\w.$]+[\\\"\\']\/i",
            "\/<java>\\s*<object\\s+class\\s*=\\s*[\\\"\\'][^\\\"\\']*[\"]\/i",
            "\/\\b(?:pickle\\.(?:loads|load|Unpickler))\\s*\\(\/i",
            "\/!!python\\\/object\\\/apply:\/i",
            "\/\\bvm2\\s*\\.\\s*(?:VM|NodeVM|VMScript)\\s*\\.\/i",
            "\/_\\$\\$ND_FUNC\\$\\$_\/i",
            "\/\\b(?:BinaryFormatter|LosFormatter|NetDataContractSerializer)\\s*\\.\\s*Deserialize\\s*\\(\/i",
            "\/__VIEWSTATE=[a-zA-Z0-9+\\\/]*?(?:AAEA|AQAA|AgAA|AwAA)\/i",
            "\/\\b(?:base64_decode|gzinflate|gzuncompress|str_rot13)\\s*\\([^)]*\\b(?:Tzo|O:|rknj|flfgrz|c3lzdGVt|ZXZhbHw=)\/i",
            "\/%[0-9a-fA-F]{2}%[0-9a-fA-F]{2}(?:O%3A|a%3A|s%3A)\/i",
            "\/O\\s*:\\s*\\d+\\s*:\\s*[\\\"\\']\\s*(?:SoapClient|SplDoublyLinkedList)\/i",
            "\/^O:\\d+:\/m"
        ],
        "xss": [
            "\/<[\\s\\\/]*script[^>]*>[^<]*<\\\/script[^>]*>\/i",
            "\/<[\\s\\\/]*script[^>]*>\/i",
            "\/on\\w+\\s*=\\s*[\\\"\\'][^\\\"\\']*?[\\\"\\']\/i",
            "\/<[\\s\\\/]*img[^>]*on\\w+[^>]*>\/i",
            "\/<[\\s\\\/]*svg[^>]*on\\w+[^>]*>\/i",
            "\/<[\\s\\\/]*iframe[^>]*>\/i",
            "\/javascript\\s*:\/i",
            "\/data\\s*:\\s*text\\\/html\\s*;\/i",
            "\/&\\s*#(?:x[0-9a-fA-F]+|\\d+);\/i",
            "\/%3C(?:script|img|svg|iframe)\/i",
            "\/\\\/+ADw-\\\/+AD4-\/i",
            "\/\\u003c\/i",
            "\/<[\\s\\n\\r\\t]*script[\\s\\n\\r\\t]*>\/i",
            "\/expression\\s*\\(\/i",
            "\/#.*?document\\.(?:write|cookie|location)\/i",
            "\/\\{\\{.*?\\}\\}\/i",
            "\/callback\\s*=\\s*[\\\"\\'].*?[\\\"\\']\/i",
            "\/String\\.fromCharCode\\s*\\(\/i",
            "\/<svg[^>]*onload\\s*=\/i",
            "\/alert\\s*\\(\/i",
            "\/contenteditable\\s*=\\s*[\\\"\\']true[\\\"\\']\/i"
        ],
        "xxe": [
            "\/<!DOCTYPE\\s+[^>]*\\[\\s*<!ENTITY\\s+[^>]*SYSTEM\\s*[\\\"'][^>]*file:[^>]*[\\\"'][^>]*>\\s*\\][^>]*>\/is",
            "\/<!ENTITY\\s+[^>]*SYSTEM\\s*[\\\"']\\s*file:\\\/\\\/[^>]*[\\\"']\\s*>\/is",
            "\/<\\?xml[^>]*>\\s*<!DOCTYPE[^>]*\\[\\s*<!ENTITY[^>]*>\\s*\\][^>]*>\/is",
            "\/loadExternalDTD|resolveEntity|setExternalGeneralEntities|setExternalParameterEntities|setFeature.*http:\\\/\\\/xml\\.org\\\/sax\\\/features\\\/external-general-entities|setFeature.*http:\\\/\\\/xml\\.org\\\/sax\\\/features\\\/external-parameter-entities\/i",
            "\/<!DOCTYPE.*\\[.*<!ENTITY.*%.*remote.*SYSTEM.*['\"].*http.*['\"].*>.*%remote.*;.*\\]>\/is",
            "\/<!ENTITY.*%.*start.*\\[.*<!ENTITY.*%.*goodies.*SYSTEM.*['\"].*file:.*\\\/\\\/.*etc.*passwd.*['\"].*>.*%goodies.*;.*<!ENTITY.*%.*end.*\\[.*'.*'>.*\\]>\/is",
            "\/<xi:include.*href=.*['\"].*file:.*['\"].*\\\/>\/is",
            "\/xmlns:xi=['\"]http:\\\/\\\/www\\.w3\\.org\\\/2001\\\/XInclude['\"]\/i",
            "\/<xi:include.*parse=['\"]text['\"].*\\\/>\/is",
            "\/<svg.*xmlns=['\"].*['\"].*>.*<!ENTITY.*%.*remote.*SYSTEM.*['\"].*http:.*['\"].*>.*%remote.*;.*<\\\/svg>\/is",
            "\/<soap:Envelope.*>.*<!DOCTYPE.*>.*<\\\/soap:Envelope>\/is",
            "\/<soap:Body.*>.*&.*;.*<\\\/soap:Body>\/is",
            "\/<\\?mso-application.*progid=['\"]Word\\.Document['\"].*\\?>\/i",
            "\/<w:wordDocument.*>.*<!ENTITY.*SYSTEM.*>.*<\\\/w:wordDocument>\/is",
            "\/<!ENTITY.*%.*file.*SYSTEM.*['\"].*file:.*\\\/\\\/.*etc.*hostname.*['\"].*>.*<!ENTITY.*%.*eval.*\\[.*<!ENTITY.*%.*exfil.*SYSTEM.*['\"].*http:.*\\\/\\\/.*\\?.*%file.*;.*['\"].*>.*>.*%eval.*;.*%exfil.*;\/is",
            "\/<!ENTITY.*%.*error.*SYSTEM.*['\"].*file:.*\\\/\\\/.*nonexistent.*['\"].*>.*%error.*;\/is"
        ],
        "ssrf": {
            "banned_visit_ip_blacklist": [
                "127.0.0.0\/8",
                "10.0.0.0\/8",
                "172.16.0.0\/12",
                "192.168.0.0\/16",
                "169.254.0.0\/16",
                "0.0.0.0\/8",
                "224.0.0.0\/4",
                "240.0.0.0\/4"
            ],
            "protocol_whitelist": [
                "http",
                "https"
            ],
            "protocol_blacklist": [
                "file",
                "gopher",
                "dict",
                "ldap",
                "ldaps",
                "tftp",
                "ftp",
                "sftp",
                "telnet",
                "ssh",
                "redis",
                "memcached",
                "mongodb",
                "mysql",
                "postgresql",
                "oracle",
                "mssql",
                "data",
                "php",
                "phar",
                "expect",
                "zip",
                "jar"
            ],
            "banned_visit_domain_blacklist": [
                "localhost",
                "localdomain",
                "*.internal",
                "*.intranet",
                "*.priv",
                "*.private",
                "*.corp",
                "*.corporate",
                "*.vpn",
                "*.dmz",
                "*.dev",
                "*.test",
                "*.qa",
                "*.staging",
                "*baidu.com"
            ],
            "restricted_ports": [
                22,
                23,
                25,
                53,
                110,
                135,
                139,
                143,
                445,
                993,
                995,
                1433,
                1521,
                3306,
                3389
            ],
            "header_checks": [
                {
                    "header": "Host",
                    "pattern": "\/^[a-zA-Z0-9.-]+$\/"
                },
                {
                    "header": "X-Forwarded-For",
                    "pattern": "\/^[0-9.,\\s]+$\/"
                },
                {
                    "header": "X-Real-IP",
                    "pattern": "\/^[0-9.]+$\/"
                }
            ],
            "ip_obfuscation_patterns": [
                "\/\\b(?:2130706433|3232235521|2886729729|16843009)\\b\/",
                "\/0x[0-9a-fA-F]{8}\/",
                "\/\\b(?:0x7f000001|0xc0a80001|0xac100001)\\b\/i",
                "\/0[0-7]{9,12}\/",
                "\/\\b(?:0177\\.0\\.0\\.1|0300\\.0250\\.0\\.1)\\b\/",
                "\/１２７．０．０．１\/",
                "\/¹²⁷․⁰․⁰․¹\/",
                "\/127\\.1\\b\/",
                "\/127\\.0\\.1\\b\/",
                "\/0\\b\/",
                "\/(?:127\\.0\\.0\\.0x[0-9a-fA-F]+|192\\.168\\.0x[0-9a-fA-F]+\\.\\d+)\/i"
            ]
        },
        "flag_file": [
            "\/flag\\.(txt|php|html|htm)\/i",
            "\/\\bflag{[^}]+}\/i",
            "\/secret\\.(txt|php|key)\/i",
            "\/password\\.(txt|php)\/i"
        ],
        "ip": [
            "\/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$\/",
            "\/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\\/\\d{1,2}$\/"
        ]
    },
    "upload": {
        "whitelist": "\/\\.(jpg|jpeg|png|gif|bmp|pdf|txt|doc|docx|xls|xlsx)$\/i",
        "black_ext": "\/\\.(php|phtml|php3|php4|php5|php7|phps|php8|pl|py|rb|sh|bash|exe|bat|cmd|js|jsp|asp|aspx|html|htm|xml)$\/i",
        "content_check": [
            "\/<\\?php\/i",
            "\/<\\?=\/i",
            "\/<script\\s+language\\s*=\\s*[\\\"']?php[\\\"']?\/i",
            "\/eval\\s*\\(\/i",
            "\/base64_decode\\s*\\(\/i",
            "\/system\\s*\\(\/i",
            "\/exec\\s*\\(\/i",
            "\/passthru\\s*\\(\/i",
            "\/shell_exec\\s*\\(\/i"
        ]
    },
    "headers": {
        "safe_headers": [
            "Content-Type",
            "content-type",
            "CONTENT-TYPE",
            "User-Agent",
            "user-agent",
            "USER-AGENT",
            "Accept",
            "accept",
            "ACCEPT",
            "Accept-Language",
            "accept-language",
            "ACCEPT-LANGUAGE",
            "Accept-Encoding",
            "accept-encoding",
            "ACCEPT-ENCODING",
            "Connection",
            "connection",
            "CONNECTION",
            "Sec-Ch-Ua",
            "sec-ch-ua",
            "SEC-CH-UA",
            "Sec-Ch-Ua-Mobile",
            "sec-ch-ua-mobile",
            "SEC-CH-UA-MOBILE",
            "Sec-Ch-Ua-Platform",
            "sec-ch-ua-platform",
            "SEC-CH-UA-PLATFORM",
            "Upgrade-Insecure-Requests",
            "upgrade-insecure-requests",
            "UPGRADE-INSECURE-REQUESTS",
            "Cache-Control",
            "cache-control",
            "CACHE-CONTROL",
            "DNT",
            "dnt",
            "Referer",
            "referer",
            "REFERER"
        ],
        "danger_patterns": [
            "\/\\r\\n\/",
            "\/%0D%0A\/",
            "\/\\b(?:Host|X-Forwarded-For|X-Real-IP)\\s*:\/i"
        ]
    }
}